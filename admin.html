<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>ADMIN DASHBOARD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&family=Outfit:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root {
            --primary: #00d2ff;
            --primary-glow: rgba(0, 210, 255, 0.4);
            --bg-dark: #0a0c10;
            --card-bg: rgba(255, 255, 255, 0.03);
            --sidebar-width: 280px;
            --accent: #7000ff;
        }

        body {
            background: radial-gradient(circle at top right, #1a1f2c, var(--bg-dark));
            color: #e0e6ed;
            font-family: 'Outfit', 'Kanit', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* --- Custom Scrollbar --- */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

        /* --- Sidebar Modern --- */
        .sidebar {
            width: var(--sidebar-width);
            height: calc(100vh - 40px);
            position: fixed;
            left: 20px;
            top: 20px;
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px;
            padding: 30px 15px;
            z-index: 1000;
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar-brand {
            padding: 0 15px 30px;
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
        }

        .nav-link {
            color: rgba(255, 255, 255, 0.5);
            padding: 14px 20px;
            border-radius: 16px;
            margin-bottom: 8px;
            transition: 0.3s all;
            display: flex;
            align-items: center;
            font-weight: 500;
            border: 1px solid transparent;
        }

        .nav-link i { font-size: 1.2rem; width: 30px; }

        .nav-link:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(5px);
        }

        .nav-link.active {
            color: #fff;
            background: linear-gradient(90deg, rgba(0, 210, 255, 0.2), transparent);
            border-left: 4px solid var(--primary);
            box-shadow: 15px 0 30px rgba(0, 210, 255, 0.1);
        }

        
        .page-header { margin-bottom: 40px; }
        .page-header h2 { font-weight: 700; font-size: 2.2rem; letter-spacing: -1px; }

        /* --- Premium Cards --- */
        .admin-card {
            background: rgba(15, 18, 24, 0.6); /* ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏™‡∏µ‡∏î‡∏≥‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡∏∂‡πâ‡∏ô */
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px;
            backdrop-filter: blur(15px); /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ö‡∏•‡∏≠‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏° */
        }

        .admin-card:hover { border-color: rgba(0, 210, 255, 0.2); }

        /* --- Inputs --- */
        .input-label {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .input-admin {
            background: rgba(0,0,0,0.4);
            border: 1px solid rgba(255,255,255,0.1);
            color: #fff;
            border-radius: 14px;
            padding: 14px 18px;
            width: 100%;
            transition: 0.3s;
        }

        .input-admin:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 15px var(--primary-glow);
            background: rgba(0,0,0,0.6);
        }

        /* --- Buttons --- */
        .action-bar {
            position: fixed;
            bottom: 30px;
            right: 40px;
            background: rgba(10, 12, 16, 0.8);
            padding: 15px 25px;
            border-radius: 100px;
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255,255,255,0.1);
            display: flex;
            gap: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            z-index: 1001;
        }

        .btn-modern {
            border-radius: 100px;
            padding: 12px 28px;
            font-weight: 600;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-save {
            background: var(--primary);
            border: none;
            color: #000;
            box-shadow: 0 0 20px var(--primary-glow);
        }

        .btn-save:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 30px var(--primary-glow);
            background: #fff;
        }

        /* --- Table Styling --- */
        /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡πÇ‡∏õ‡∏£‡πà‡∏á‡πÉ‡∏™ ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á Bootstrap ‡∏°‡∏≤‡πÉ‡∏ä‡πâ */
        .table {
            --bs-table-bg: transparent !important; /* ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏™ */
            --bs-table-color: #fff !important;
            margin-bottom: 0;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏ï‡∏≤ */
        .table thead th {
            background: rgba(0, 0, 0, 0.2); /* ‡πÄ‡∏ô‡πâ‡∏ô‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏µ‡∏î‡∏≥‡∏à‡∏≤‡∏á‡πÜ */
            border-bottom: 1px solid rgba(255, 255, 255, 0.05) !important;
            color: var(--primary) !important; /* ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ */
            font-weight: 600;
            padding: 20px 15px;
        }

        /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏™‡∏•‡∏±‡∏ö‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ô‡∏µ‡∏¢‡∏ô‡πÜ */
        .table tbody tr {
            background: transparent !important;
            transition: 0.3s ease;
        }

        .table tbody tr:hover {
            background: rgba(255, 255, 255, 0.03) !important; /* ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß */
        }

        .table td {
            border-bottom: 1px solid rgba(255, 255, 255, 0.03) !important;
            padding: 18px 15px;
        }
        .table td:first-child { border-radius: 15px 0 0 15px; }
        .table td:last-child { border-radius: 0 15px 15px 0; }

        .section-panel { display: none; }
        .section-panel.active { display: block; animation: slideUp 0.6s cubic-bezier(0.23, 1, 0.32, 1); }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .badge-role {
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
        }
        /* ‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å‡πÉ‡∏´‡πâ‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ */
        .main-content {
            margin-left: calc(var(--sidebar-width) + 100px) !important;
            width: calc(100% - (var(--sidebar-width) + 100px)) !important;
            padding: 20px 40px !important;
            box-sizing: border-box; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Padding ‡∏î‡∏±‡∏ô‡∏à‡∏ô UI ‡∏•‡πâ‡∏ô */
            min-height: 100vh;
        }

        /* ‡∏Å‡∏£‡∏≠‡∏ö‡πÅ‡∏ä‡∏ó - ‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ú‡πà‡∏à‡∏ô‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ß */
        .chat-wrapper-mini {
            display: flex;
            width: 100%;
            max-width: 900px; 
            height: 600px;
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            overflow: hidden;
            backdrop-filter: blur(20px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }

        /* ‡∏ù‡∏±‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ (‡∏ã‡πâ‡∏≤‡∏¢) - ‡∏•‡πá‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏¢‡∏ï‡∏±‡∏ß 260px */
        .chat-sidebar-mini {
            width: 260px;
            min-width: 260px;
            background: rgba(0, 0, 0, 0.3);
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
        }

        /* ‡∏ù‡∏±‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢ (‡∏Ç‡∏ß‡∏≤) - ‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏ï‡∏≤‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ */
        .chat-main-mini {
            flex: 1; 
            min-width: 0; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏î‡∏±‡∏ô‡∏à‡∏ô UI ‡πÅ‡∏ï‡∏Å */
            display: flex;
            flex-direction: column;
        }

        /* ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏ß‡∏≤‡∏á Bubble */
        .chat-content-mini {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .bubble-mini {
            max-width: 80%;
            padding: 10px 16px;
            border-radius: 18px;
            font-size: 14px;
            word-wrap: break-word;
        }

        .admin-bubble {
            align-self: flex-end; /* ‡∏ä‡∏¥‡∏î‡∏Ç‡∏ß‡∏≤ */
            background: var(--primary);
            color: #000;
            border-bottom-right-radius: 4px;
        }

        .user-bubble {
            align-self: flex-start; /* ‡∏ä‡∏¥‡∏î‡∏ã‡πâ‡∏≤‡∏¢ */
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border-bottom-left-radius: 4px;
        }
        /* ‡∏™‡πà‡∏ß‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á */
        .chat-input-area-mini {
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-brand">
            <i class="fa-solid fa-users-gear me-3"></i> ADMIN PANEL
        </div>
        <div class="nav-link active" onclick="showSection('general')">
            <i class="fa-solid fa-house-user"></i> <span>‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</span>
        </div>
        <div class="nav-link" onclick="showSection('appearance')">
            <i class="fa-solid fa-wand-magic-sparkles"></i> <span>‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ò‡∏µ‡∏°</span>
        </div>
        <div class="nav-link" onclick="showSection('systems')">
            <i class="fa-solid fa-terminal"></i> <span>‡∏£‡∏∞‡∏ö‡∏ö & ‡∏ö‡∏≠‡∏ó</span>
        </div>
        <a href="adminchat.html" class="nav-link" style="text-decoration: none;">
            <i class="fa-solid fa-comments"></i> <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏ó</span>
        </a>
        <div class="nav-link" onclick="showSection('users-manage')">
            <i class="fa-solid fa-user-shield"></i> <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
        </div>
        <div class="nav-link" onclick="showSection('payment-manage')">
            <i class="fa-solid fa-wallet"></i> <span>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</span>
        </div>
        
        <div style="position: absolute; bottom: 30px; width: calc(100% - 30px);">
            <a href="index.html" class="nav-link text-info">
                <i class="fa-solid fa-arrow-up-right-from-square"></i> <span>‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</span>
            </a>
        </div>
    </div>

    <div class="main-content">
        <div id="general" class="section-panel active">
            <div class="page-header">
                <h2>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏£‡∏ß‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h2>
                <p class="text-white-50">‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</p>
            </div>
            <div class="admin-card">
                <div class="row g-4">
                    <div class="col-md-6">
                        <label class="input-label">‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏ö‡∏£‡∏ô‡∏î‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</label>
                        <input type="text" id="conf-sitename" class="input-admin" placeholder="Site Name">
                    </div>
                    <div class="col-md-6">
                        <label class="input-label">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</label>
                        <input type="text" id="conf-accenttext" class="input-admin" placeholder="‡πÄ‡∏ä‡πà‡∏ô BEST QUALITY">
                    </div>
                    <div class="col-md-12">
                        <label class="input-label">‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏° Discord</label>
                        <input type="text" id="conf-discord-link" class="input-admin" placeholder="https://discord.gg/...">
                    </div>
                    <div class="col-md-6">
                        <label class="input-label">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡∏£‡∏µ‡πÄ‡∏ä‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ 0 ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á)</label>
                        <input type="text" id="conf-stat1-value" class="input-admin">
                    </div>
                    <div class="col-md-6">
                        <label class="input-label">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢ (‡∏£‡∏µ‡πÄ‡∏ä‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ 0 ‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á)</label>
                        <input type="text" id="conf-stat2-value" class="input-admin">
                    </div>
                    <div class="col-md-12">
                        <label class="input-label">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤</label>
                        <textarea id="conf-sitedesc" class="input-admin" rows="4"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div id="appearance" class="section-panel">
            <div class="page-header">
                <h2>‡∏£‡∏π‡∏õ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡πå & ‡∏ò‡∏µ‡∏°</h2>
                <p class="text-white-50">‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏ó‡∏ô‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πÑ‡∏ï‡∏•‡πå‡∏Ñ‡∏∏‡∏ì</p>
            </div>
            <div class="admin-card">
                <div class="row text-center">
                    <div class="col-md-4">
                        <div class="p-4 rounded-4" style="background: rgba(0,0,0,0.2);">
                            <label class="input-label d-block mb-3">‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö</label>
                            <input type="color" id="conf-color" class="form-control-color w-100 border-0 bg-transparent" style="height: 80px;">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="p-4 rounded-4" style="background: rgba(0,0,0,0.2);">
                            <label class="input-label d-block mb-3">‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö</label>
                            <input type="color" id="conf-bg-color" class="form-control-color w-100 border-0 bg-transparent" style="height: 80px;">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="p-4 rounded-4" style="background: rgba(0,0,0,0.2);">
                            <label class="input-label d-block mb-3">‡∏™‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö</label>
                            <input type="color" id="conf-text-color" class="form-control-color w-100 border-0 bg-transparent" style="height: 80px;">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="users-manage" class="section-panel">
            <div class="d-flex justify-content-between align-items-end page-header">
                <div>
                    <h2>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>
                    <p class="text-white-50">‡∏î‡∏π‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                </div>
                <div style="width: 350px;">
                    <div class="input-group">
                        <span class="input-group-text bg-transparent border-secondary border-end-0 text-white-50">
                            <i class="fa-solid fa-search"></i>
                        </span>
                        <input type="text" id="user-search-input" class="form-control bg-transparent border-secondary border-start-0 text-white shadow-none" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠...">
                    </div>
                </div>
            </div>
            <div class="admin-card p-0 overflow-hidden">
                <div class="table-responsive">
                    <table class="table m-0">
                        <thead>
                            <tr>
                                <th class="ps-4">USERNAME</th>
                                <th>EMAIL</th>
                                <th>ROLE</th>
                                <th class="text-end pe-4">ACTIONS</th>
                            </tr>
                        </thead>
                        <tbody id="user-list-table">
                            <tr><td colspan="4" class="text-center py-5">
                                <div class="spinner-border text-primary" role="status"></div>
                            </td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="payment-manage" class="section-panel">
            <div class="page-header">
                <h2>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</h2>
                <p class="text-white-50">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</p>
            </div>
            <div class="admin-card p-0 overflow-hidden">
                <div class="table-responsive">
                    <table class="table m-0">
                        <thead>
                            <tr>
                                <th class="ps-4">TIME</th>
                                <th>CUSTOMER</th>
                                <th>AMOUNT</th>
                                <th>METHOD/REF</th>
                                <th>STATUS</th>
                                <th class="text-end pe-4">MANAGE</th>
                            </tr>
                        </thead>
                        <tbody id="all-payment-table">
                            </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <div id="systems" class="section-panel">
            <div class="page-header">
                <h2>‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å</h2>
                <p class="text-white-50">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Webhook ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ Discord</p>
            </div>
            <div class="admin-card">
                 <div class="mb-4">
                    <label class="input-label"><i class="fa-brands fa-discord me-2"></i> System Webhook (‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)</label>
                    <input type="text" id="conf-discord-webhook" class="input-admin" placeholder="https://discord.com/api/webhooks/...">
                 </div>
                 <div>
                    <label class="input-label"><i class="fa-solid fa-user-plus me-2"></i> User Registration Webhook (‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö - ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å)</label>
                    <input type="text" id="conf-user-webhook" class="input-admin" placeholder="https://discord.com/api/webhooks/...">
                 </div>
            </div>
        </div>
    </div>

    <div class="action-bar">
        <button class="btn btn-modern btn-outline-danger" id="reset-config">
            <i class="fa-solid fa-rotate-left"></i> ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        </button>
        <button class="btn btn-modern btn-outline-warning" id="reset-theme-only">
            <i class="fa-solid fa-palette"></i> ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏™‡∏µ
        </button>
        <button class="btn btn-modern btn-save" id="save-all-config">
            <i class="fa-solid fa-check-double"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        </button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, get, update, onValue, set, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        document.addEventListener('keydown', function(e) {
    // 1. ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Ctrl + S (Save Page)
    if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'S' || e.keyCode === 83)) {
        e.preventDefault();
        // showAlert("‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö", "danger"); // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
        return false;
    }

    // 2. ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô F12 (DevTools)
    if (e.key === 'F12' || e.keyCode === 123) {
        e.preventDefault();
        return false;
    }

    // 3. ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Ctrl + Shift + I / J / C (Inspect/Console)
    if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C' || e.keyCode === 73 || e.keyCode === 74 || e.keyCode === 67)) {
        e.preventDefault();
        return false;
    }

    // 4. ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Ctrl + U (View Source)
    if ((e.ctrlKey || e.metaKey) && (e.key === 'u' || e.key === 'U' || e.keyCode === 85)) {
        e.preventDefault();
        return false;
    }
}, false);


        const firebaseConfig = {
            apiKey: "AIzaSyAu_tpFJkolV90YBMFwzSUIu8KnusAB8mg",
            authDomain: "verify-hiz.firebaseapp.com",
            databaseURL: "https://verify-hiz-default-rtdb.firebaseio.com",
            projectId: "verify-hiz",
            storageBucket: "verify-hiz.firebasestorage.app",
            messagingSenderId: "1001871666471",
            appId: "1:1001871666471:web:daea600bd157f907634d02"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        // --- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô Toast ---
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 2000,
            timerProgressBar: true,
            background: '#1a1d21',
            color: '#fff'
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà ‡∏î‡∏∂‡∏á URL ‡∏à‡∏≤‡∏Å Database ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
        const sendDiscordLog = async (title, message, color = 5814783) => {
            try {
                // 1. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Å‡πâ‡∏≠‡∏ô config ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô
                const snapshot = await get(ref(db, 'config'));
                const configData = snapshot.val();
                
                // 2. ‡∏•‡∏≠‡∏á‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ webhook ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ (‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÉ‡∏ô Firebase)
                const webhookUrl = configData.discordWebhook; 

                if (!webhookUrl) {
                    console.error("‚ùå ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ discordWebhook ‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠‡πÉ‡∏ô Firebase");
                    return;
                }

                // 3. ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Discord
                await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        embeds: [{
                            title: title,
                            description: message,
                            color: color,
                            timestamp: new Date().toISOString()
                        }]
                    })
                });
                console.log("‚úÖ ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!");
            } catch (err) { 
                console.error("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:", err); 
            }
        };

        const notifyDiscord = async (title, message, color = 5814783) => {
            const webhookUrl = document.getElementById('conf-discord-webhook').value;
            if (!webhookUrl || !webhookUrl.startsWith('https://discord.com/api/webhooks/')) return;
            try {
                await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        embeds: [{
                            title: title,
                            description: message,
                            color: color,
                            timestamp: new Date().toISOString(),
                            footer: { text: "‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥" }
                        }]
                    })
                });
            } catch (err) { console.error("Webhook Error:", err); }
        };

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π Sidebar ---
    // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π Sidebar ---
window.showSection = (sectionId) => {
    // 1. ‡∏ã‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å Section ‡∏Å‡πà‡∏≠‡∏ô
    document.querySelectorAll('.section-panel').forEach(panel => {
        panel.style.display = 'none';
        panel.classList.remove('active');
    });

    // 2. ‡πÄ‡∏≠‡∏≤ class active ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏∏‡∏Å‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ô Sidebar
    document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
    });

    // 3. ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Section ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
    const activePanel = document.getElementById(sectionId);
    if (activePanel) {
        activePanel.style.display = 'block';
        setTimeout(() => activePanel.classList.add('active'), 10); // ‡πÄ‡∏û‡∏¥‡πà‡∏° delay ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ Animation ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
    }

    // 4. ‡πÑ‡∏Æ‡πÑ‡∏•‡∏ó‡πå‡πÄ‡∏°‡∏ô‡∏π‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏•‡∏¥‡∏Å
    // ‡πÉ‡∏ä‡πâ‡∏´‡∏≤ element ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏≤‡∏à‡∏≤‡∏Å onclick
    const clickedLink = event ? event.currentTarget : null;
    if (clickedLink && clickedLink.classList) {
        clickedLink.classList.add('active');
    } else {
        // ‡∏Å‡∏£‡∏ì‡∏µ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ú‡πà‡∏≤‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î (‡πÄ‡∏ä‡πà‡∏ô‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å) ‡πÉ‡∏´‡πâ‡∏´‡∏≤ element ‡∏ó‡∏µ‡πà‡∏°‡∏µ onclick ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö sectionId
        const links = document.querySelectorAll('.nav-link');
        links.forEach(link => {
            if (link.getAttribute('onclick')?.includes(sectionId)) {
                link.classList.add('active');
            }
        });
    }
};

            // --- üîÑ ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ---
           // --- üîÑ 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô (‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á) ---
            document.getElementById('reset-config').onclick = () => {
                Swal.fire({
                    title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?',
                    text: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#d33',
                    confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á!',
                    background: '#1a1d21',
                    color: '#fff'
                }).then((result) => {
                    if (result.isConfirmed) {
                        const allDefaults = {
                            siteName: "NAME",
                            accentText: "GAMING SOLUTION",
                            siteDesc: "‡∏¢‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏î‡πâ‡∏ß‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î...",
                            themeColor: "#00d2ff", 
                            bgColor: "#06070a",    
                            textColor: "#ffffff",
                            stat1Value: "0",
                            stat2Value: "0"
                        };
                        update(ref(db, 'config'), allDefaults).then(async () => { // ‡πÄ‡∏û‡∏¥‡πà‡∏° async ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
                            await sendDiscordLog("‚ö†Ô∏è ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏∞‡∏ö‡∏ö", "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î", 15158332);
                            Swal.fire({ icon: 'success', title: '‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!', background: '#1a1d21', color: '#fff' });
                        });
                    }
                });
            };

            // --- üé® 2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞ "‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏ò‡∏µ‡∏°" (‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) ---
            document.getElementById('reset-theme-only').onclick = () => {
                Swal.fire({
                    title: '‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏ò‡∏µ‡∏°?',
                    text: "‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡∏µ‡∏´‡∏•‡∏±‡∏Å ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡∏µ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô",
                    icon: 'question',
                    showCancelButton: true,
                    confirmButtonColor: '#ffc107',
                    cancelButtonColor: '#3085d6',
                    confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏µ‡πÄ‡∏•‡∏¢!',
                    cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
                    background: '#1a1d21',
                    color: '#fff'
                }).then((result) => {
                    if (result.isConfirmed) {
                        // ‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
                        const themeDefaults = {
                            themeColor: "#00d2ff", 
                            bgColor: "#06070a",    
                            textColor: "#ffffff"
                        };

                        update(ref(db, 'config'), themeDefaults).then(() => {
                            sendDiscordLog("üé® ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ò‡∏µ‡∏°", "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏ò‡∏µ‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô", 15844367);
                            Swal.fire({
                                icon: 'success',
                                title: '‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏™‡∏µ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                                text: '‡∏ò‡∏µ‡∏°‡∏™‡∏µ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß',
                                background: '#1a1d21',
                                color: '#fff',
                                timer: 1500,
                                showConfirmButton: false
                            });
                        }).catch((err) => {
                            Swal.fire({ icon: 'error', title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', text: err.message });
                        });
                    }
                });
            };

    // --- üì• ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏à‡∏≤‡∏Å‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏µ‡πÉ‡∏´‡∏°‡πà) ---
    onValue(ref(db, 'config'), (snapshot) => {
        const data = snapshot.val();
        if (data) {
            document.getElementById('conf-sitename').value = data.siteName || '';
            document.getElementById('conf-sitedesc').value = data.siteDesc || '';
            document.getElementById('conf-color').value = data.themeColor || '#00d2ff';
            document.getElementById('conf-bg-color').value = data.bgColor || '#06070a'; // ‡∏î‡∏∂‡∏á‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á
            document.getElementById('conf-text-color').value = data.textColor || '#ffffff'; // ‡∏î‡∏∂‡∏á‡∏™‡∏µ‡∏ü‡∏≠‡∏ô‡∏ï‡πå
            document.getElementById('conf-discord-link').value = data.discordLink || '';
            document.getElementById('conf-discord-webhook').value = data.discordWebhook || '';
            document.getElementById('conf-user-webhook').value = data.userWebhook || ''; 
            document.getElementById('conf-accenttext').value = data.accentText || 'GAMING SOLUTION';
            document.getElementById('conf-stat1-value').value = data.stat1Value || '0';
            document.getElementById('conf-stat2-value').value = data.stat2Value || '0';
        }
    });

 // --- üíæ ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏±‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á (Save All) ---
document.getElementById('save-all-config').onclick = async () => {
    const updates = {
        siteName: document.getElementById('conf-sitename').value,
        accentText: document.getElementById('conf-accenttext').value,
        siteDesc: document.getElementById('conf-sitedesc').value,
        themeColor: document.getElementById('conf-color').value,
        bgColor: document.getElementById('conf-bg-color').value,
        textColor: document.getElementById('conf-text-color').value,
        discordLink: document.getElementById('conf-discord-link').value,
        discordWebhook: document.getElementById('conf-discord-webhook').value,
        userWebhook: document.getElementById('conf-user-webhook').value,
        stat1Value: document.getElementById('conf-stat1-value').value,
        stat2Value: document.getElementById('conf-stat2-value').value,
    };

    try {
        // 1. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡πà‡∏≤‡∏•‡∏á Firebase
        await update(ref(db, 'config'), updates);

        // 2. ‡∏î‡∏∂‡∏á Webhook URL
        const snapshot = await get(ref(db, 'config/discordWebhook'));
        let webhookUrl = snapshot.val();

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ: ‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏Ñ‡πà‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ /api/webhooks/ ‡∏Å‡πá‡∏û‡∏≠
        if (webhookUrl && webhookUrl.includes('/api/webhooks/')) {
            
            // 3. ‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
            await fetch(webhookUrl, {
                method: 'POST',
                // ‡∏•‡∏ö headers ‡∏≠‡∏≠‡∏Å‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ no-cors ‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏á‡πÑ‡∏ß‡πâ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏õ‡∏Å‡∏ï‡∏¥
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    embeds: [{
                        title: "üõ†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤",
                        description: "‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
                        color: 3066993,
                        timestamp: new Date().toISOString()
                    }]
                })
            });
        }

        Swal.fire({
            icon: 'success',
            title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
            text: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß',
            background: '#1a1d21',
            color: '#fff',
            timer: 1500,
            showConfirmButton: false
        });

    } catch (err) {
        console.error(err);
        Swal.fire({ icon: 'error', title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', text: err.message, background: '#1a1d21', color: '#fff' });
    }
};

// --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏ö‡∏ö Real-time Search ---
let allUsers = {}; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Filter

const loadUsers = () => {
    const usersRef = ref(db, 'users');
    onValue(usersRef, (snapshot) => {
        allUsers = snapshot.val() || {};
        renderUserTable(allUsers); // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
    });
};

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á
const renderUserTable = (usersData) => {
    const tableBody = document.getElementById('user-list-table');
    if (!tableBody) return;
    tableBody.innerHTML = '';

    const uids = Object.keys(usersData);
    if (uids.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="4" class="text-center py-4">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</td></tr>';
        return;
    }

    uids.forEach(uid => {
        const user = usersData[uid];
        
        // 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞ Badge
        const username = user.username || (user.email ? user.email.split('@')[0] : 'Unknown');
        const roleBadge = user.role === 'admin' ? 
            '<span class="badge bg-danger shadow-sm">Admin</span>' : 
            '<span class="badge bg-secondary opacity-75">User</span>';
        
        const btnText = user.role === 'admin' ? '‡∏•‡∏î‡πÄ‡∏õ‡πá‡∏ô User' : '‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô Admin';
        const btnClass = user.role === 'admin' ? 'btn-outline-warning' : 'btn-outline-info';

        // 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô tr ‡πÅ‡∏•‡∏∞ row ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)
        const row = `
            <tr>
                <td class="align-middle fw-bold text-info">${username}</td>
                <td class="align-middle text-white-50 small">${user.email || '-'}</td>
                <td class="align-middle">${roleBadge}</td>
                <td class="text-end">
                    <button class="btn btn-sm ${btnClass} me-2 px-3" onclick="toggleAdminRole('${uid}', '${user.role || 'user'}')">
                        <i class="fa-solid fa-user-shield me-1"></i> ${btnText}
                    </button>
                    
                    <button class="btn btn-sm btn-outline-danger" onclick="deleteUser('${uid}', '${username}')">
                        <i class="fa-solid fa-trash-can"></i>
                    </button>
                </td>
            </tr>
        `;

        // 3. ‡πÅ‡∏ó‡∏£‡∏Å‡πÅ‡∏ñ‡∏ß‡∏•‡∏á‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        tableBody.insertAdjacentHTML('beforeend', row);
    });
};

// --- ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ (Search Filter) ---
document.getElementById('user-search-input').addEventListener('input', (e) => {
    const keyword = e.target.value.toLowerCase();
    const filteredUsers = {};

    Object.keys(allUsers).forEach(uid => {
        const user = allUsers[uid];
        const username = (user.username || (user.email ? user.email.split('@')[0] : '')).toLowerCase();
        const email = (user.email || '').toLowerCase();

        if (username.includes(keyword) || email.includes(keyword)) {
            filteredUsers[uid] = user;
        }
    });

    renderUserTable(filteredUsers);
});

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏¢‡∏® (Export ‡πÉ‡∏´‡πâ HTML ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ)
window.toggleAdminRole = (uid, currentRole) => {
    const newRole = currentRole === 'admin' ? 'user' : 'admin';
    
    Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå?',
        text: `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô ${newRole.toUpperCase()} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,
        icon: 'warning',
        showCancelButton: true,
        confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
        confirmButtonColor: '#00d2ff',
        background: '#1a1d21',
        color: '#fff'
    }).then((result) => {
        if (result.isConfirmed) {
            update(ref(db, `users/${uid}`), { role: newRole })
                .then(() => {
                    Swal.fire({ icon: 'success', title: '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!', background: '#1a1d21', color: '#fff', timer: 1000, showConfirmButton: false });
                })
                .catch(err => {
                    console.error(err);
                    Swal.fire('Error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÑ‡∏î‡πâ', 'error');
                });
        }
    });
};

window.deleteUser = (uid, username) => {
    Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å?',
        text: `‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏•‡∏ö "${username}" ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£!`,
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d33',
        cancelButtonColor: '#3085d6',
        confirmButtonText: '‡πÉ‡∏ä‡πà, ‡∏•‡∏ö‡πÄ‡∏•‡∏¢!',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
        background: '#1a1d21',
        color: '#fff'
    }).then((result) => {
        if (result.isConfirmed) {
            remove(ref(db, `users/${uid}`)) // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firebase
                .then(() => {
                    Swal.fire({ icon: 'success', title: '‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', background: '#1a1d21', color: '#fff', timer: 1000, showConfirmButton: false });
                });
        }
    });
};
// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
loadUsers();

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
const getStatusBadge = (status) => {
    switch(status) {
        case 'pending': return '<span class="badge bg-warning text-dark"><i class="fa-solid fa-clock me-1"></i> ‡∏£‡∏≠‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤</span>';
        case 'success': return '<span class="badge bg-success"><i class="fa-solid fa-check-circle me-1"></i> ‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß</span>';
        case 'rejected': return '<span class="badge bg-danger">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò</span>';
        default: return '<span class="badge bg-secondary">‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏</span>';
    }
};

const loadAllPayments = () => {
    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å pending_payments
    onValue(ref(db, 'pending_payments'), (pendingSnap) => {
        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å topup_history
        onValue(ref(db, 'topup_history'), (historySnap) => {
            const tableBody = document.getElementById('all-payment-table');
            if (!tableBody) return;
            
            let combinedData = [];

            // ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
            const pendingData = pendingSnap.val();
            if (pendingData) {
                Object.keys(pendingData).forEach(id => {
                    combinedData.push({ id, ...pendingData[id], type: 'Manual' });
                });
            }

            // ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß
            const historyData = historySnap.val();
            if (historyData) {
                Object.keys(historyData).forEach(id => {
                    // ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ô history ‡πÑ‡∏°‡πà‡∏°‡∏µ status ‡πÉ‡∏´‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô success
                    combinedData.push({ id, ...historyData[id], status: historyData[id].status || 'success' });
                });
            }

            // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (Date ISO)
            combinedData.sort((a, b) => new Date(b.date) - new Date(a.date));

            tableBody.innerHTML = '';
            if (combinedData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="6" class="text-center py-4">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</td></tr>';
                return;
            }

            combinedData.forEach(item => {
                const dateStr = new Date(item.date).toLocaleString('th-TH');
                const row = `
                    <tr>
                        <td class="align-middle small">${dateStr}</td>
                        <td class="align-middle">${item.email || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</td>
                        <td class="align-middle text-info fw-bold">‡∏ø${item.amount}</td>
                        <td class="align-middle small text-white-50">
                            ${item.type || 'Auto'}<br>
                            <span class="text-secondary">${item.refNo || item.id}</span>
                        </td>
                        <td class="align-middle">${getStatusBadge(item.status)}</td>
                        <td class="text-end">
                            ${item.status === 'pending' ? `
                                <button class="btn btn-sm btn-success me-1" onclick="approvePayment('${item.id}', '${item.uid}', ${item.amount}, '${item.email}')">
                                    ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
                                </button>
                                <button class="btn btn-sm btn-outline-danger" onclick="rejectPayment('${item.id}')">
                                    <i class="fa-solid fa-xmark"></i>
                                </button>
                            ` : `
                                <span class="text-white-50 small">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß</span>
                            `}
                        </td>
                    </tr>
                `;
                tableBody.insertAdjacentHTML('beforeend', row);
            });
        });
    });
};

// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô approvePayment ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏¢‡πâ‡∏≤‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ history ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå
window.approvePayment = async (payId, uid, amount, email) => {
    const result = await Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥?',
        text: `‡πÄ‡∏á‡∏¥‡∏ô ‡∏ø${amount} ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ç‡∏≠‡∏á ${email}`,
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#198754'
    });

    if (result.isConfirmed) {
        try {
            // 1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏á‡∏¥‡∏ô
            const userRef = ref(db, `users/${uid}/credits`);
            const snap = await get(userRef);
            const current = snap.val() || 0;
            await set(userRef, current + amount);

            // 2. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Ç‡πâ‡∏≤ History (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Success)
            await set(ref(db, `topup_history/${payId}`), {
                uid, email, amount, date: new Date().toISOString(), status: 'success', type: 'Manual'
            });

            // 3. ‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å Pending
            await remove(ref(db, `pending_payments/${payId}`));

            Toast.fire({ icon: 'success', title: '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!' });
        } catch (err) {
            Swal.fire('Error', err.message, 'error');
        }
    }
};

// ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
loadAllPayments();

window.onload = () => {
    showSection('general'); 
};

    </script>
</body>
</html>
